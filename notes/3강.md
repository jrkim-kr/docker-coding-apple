# 핵심 정리

## 🎯 학습 목표

이 튜토리얼을 완료하면:

- Node.js로 간단한 웹서버를 만들 수 있습니다
- Docker 이미지 만들기 전에 필요한 서버 개발 과정을 이해합니다
- 실제 배포 시나리오를 통해 Docker의 필요성을 체감합니다

> 왜 이걸 먼저 배워야 할까요? 🤔
>
> Docker 명령어만 외우면 다음날 다 까먹습니다! 실제 상황에서 활용해보는 것이 진짜 학습입니다.

---

## 📚 서버란 무엇인가?

서버는 사실 매우 단순한 개념입니다:

**"누가 A라는 자료를 요청하면 A라는 자료를 보내주는 호구같은 프로그램"**

### 실제 예시들

- **유튜브 서버**: "유저가 동영상 요구하면 → 동영상을 보내주기"
- **네이버 뉴스 서버**: "유저가 뉴스 요구하면 → 뉴스를 보내주기"
- **우리가 만들 서버**: "접속하면 → 인사말을 보내주기" (호구처럼 보이지 않게!)

---

## 🛠️ 서버 만들기 4단계

### 1단계: Node.js 설치

Node.js는 자바스크립트 코드를 컴퓨터 어디서나 실행할 수 있게 해주는 프로그램입니다.

1. 구글에서 "Node.js" 검색
2. **LTS 버전** 다운로드 (가장 안정적인 버전)
3. 설치 완료

> 💡 팁: 맥이나 윈도우나 설치 방법은 동일합니다!

### 2단계: 작업 환경 준비

1. **작업용 폴더** 생성 (예: `my-server`)
2. **VSCode 에디터**로 해당 폴더 열기
3. 폴더 안에 `server.js` 파일 생성 준비

---

## 📦 라이브러리 설치 (Express)

웹서버를 쉽게 만들어주는 Express 라이브러리를 설치해봅시다.

### 터미널에서 차례대로 실행:

```bash
# 1. 라이브러리 관리 파일 생성
npm init -y

# 2. Express 라이브러리 설치
npm install express

```

성공하면 `node_modules` 폴더와 `package.json` 파일이 생성됩니다.

### 🚨 설치가 안 되는 경우 해결법

**Windows 사용자:**

```bash
# PowerShell을 관리자 모드로 실행 후
Set-ExecutionPolicy RemoteSigned

```

**Mac 사용자:**

```bash
# sudo를 앞에 붙여서 실행
sudo npm install express

```

**공통 주의사항:**

- OneDrive 폴더에서는 작업하지 마세요
- 한글 폴더명 사용 금지
- 반드시 작업폴더를 에디터로 열고 터미널 실행

---

## 💻 서버 코드 작성

`server.js` 파일에 다음 코드를 복사하여 붙여넣으세요:

```jsx
const express = require("express");
const app = express();

app.listen(8080, () => {
  console.log("서버 실행중 http://localhost:8080");
});

app.get("/", (req, res) => {
  res.send("안녕하세요! 첫 번째 서버입니다 🚀");
});
```

### 코드 설명

- `express` 라이브러리를 가져와서 사용
- `localhost:8080` 주소에 서버를 띄움
- 메인페이지(`/`)로 접속하면 인사말을 보여줌

> 개성 추가하기: "안녕하세요!" 부분을 자신만의 메시지로 바꿔보세요!

---

## 🚀 서버 실행하기

터미널에서 다음 명령어 실행:

```bash
node server.js

```

성공하면 "서버 실행중 http://localhost:8080" 메시지가 나타납니다.

### 테스트하기

1. 웹브라우저 열기
2. 주소창에 `localhost:8080` 입력
3. 여러분이 설정한 메시지가 화면에 나타나는지 확인!

### 🔄 개발 편의 기능 (선택사항)

코드 수정 시 자동으로 서버를 재시작하려면:

```bash
# nodemon 설치
npm install -g nodemon

# nodemon으로 서버 실행
nodemon server.js

```

**nodemon 설치 후 `command not found` 오류가 나는 경우:**

```bash
# 1. npm 글로벌 경로 확인
npm prefix -g

# 2. PATH에 추가 (경로는 1번 결과에 따라 조정)
echo 'export PATH=$PATH:/Users/사용자명/.npm-global/bin' >> ~/.zshrc
source ~/.zshrc

# 3. 재시도
nodemon server.js

```

---

## 🌐 실제 배포는 어떻게?

현재 서버는 여러분 컴퓨터에서만 돌아갑니다. 실제 배포하려면:

### 전통적인 방법 (귀찮고 위험한 방법)

1. AWS 같은 곳에서 서버 컴퓨터 빌리기
2. 그 컴퓨터에서 똑같이 4단계 반복
3. "서버IP주소:8080"으로 접속

### 문제점들

- 😫 **매우 귀찮음**: 컴퓨터마다 설정 반복
- 🐛 **환경 차이**: 컴퓨터마다 다른 환경으로 예상치 못한 오류
- 🔧 **유지보수 어려움**: 여러 서버 관리 복잡

---

## 🐳 Docker가 필요한 이유

Docker를 사용하면:

1. **내 환경과 코드를 이미지로 만들기**
   - 모든 설정과 코드가 하나로 패키징
   - 어떤 컴퓨터에서도 동일하게 실행
2. **간단한 배포**
   - 이미지만 옮겨서 실행
   - 환경 설정 걱정 없음

---

# 이슈

### 문제

`npm install -g nodemon` 으로 글로벌 설치했는데도 `zsh: command not found: nodemon` 오류가 남.

<img width="1046" height="396" alt="image" src="https://github.com/user-attachments/assets/d80676d6-498a-436f-93b8-181f6609eb05" />

### 원인

**npm 글로벌 패키지 경로가 PATH에 잡히지 않아서** 생기는 문제임

### 해결 방법

1. 먼저 경로 확인:

   ```bash
   npm prefix -g
   ```

   - 결과가 /Users/jrkim/.npm-global 이라면, nodemon 실행 파일은 /Users/jrkim/.npm-global/bin/nodemon 에 있음

2. PATH에 추가:

   ```bash
   echo 'export PATH=$PATH:/Users/jrkim/.npm-global/bin' >> ~/.zshrc
   source ~/.zshrc
   ```

3. 확인:

   ```bash
   nodemon -v
   ```

그리고 다시 nodemon server.js 실행하면 코드 수정 → 저장 → 새로고침하면 반영됨 (강의에서는 저장만 하면 반영이 된다는데 나는 안 됨)

# 강의 스크립트

도커 명령어 깔짝대기만 하면 어짜피 다음날 다 까먹습니다.

실제로 활용해보는 식으로 배워야 기억에 오래남습니다.

그래서 웹서버를 하나 만들어서 그걸 이미지로 만들어서 배포를 하는 상황에서 도커를 배워보도록 합시다.

실제로도 그렇게 도커를 가장 많이 사용합니다.

> 서버만들기

Node.js 사용하면 서버는 5분이면 누구나 만들 수 있는데 일단 서버가 뭐냐면

"누가 A라는 자료를 요청하면 A라는 자료를 보내주기"

이게 작성되어있는 간단한 프로그램입니다.

예를 들어 유튜브 서버는

"유저가 동영상 요구하면 동영상을 보내주기"

라고 작성되어있습니다.

예를 들어 네이버 뉴스 서버는

"유저가 뉴스 요구하면 뉴스를 보내주기"

라고 작성되어있습니다.

그런 호구같은 프로그램을 우리가 서버라고 부릅니다.

그래서 우리는 호구처럼 보이지 않도록 "접속하면 욕설을 보내주는 서버"를 만들어봅시다.

제일 쉬운 Node.js를 사용해볼 것인데 4-step을 거치면 서버가 완성됩니다.

1. Node.js 설치

2. Express 라이브러리 설치

3. 코드짜기

4. 코드실행

중요한 점은 이걸 잘 기억해야 앞으로 도커도 잘 사용할 수 있습니다.

밀키트 만들 때 이 작업 그대로 하라고 도커쨩에게 명령해야하니까요.

> 서버만들기 1. Node.js 설치

Node.js는 자바스크립트 코드를 컴퓨터 아무데서나 실행할 수 있게 도와주는 프로그램인데

이게 있으면 서버도 만들고 그럴 수 있습니다.

구글에 Node.js 검색해서 LTS라고 써있는 버전을 다운받아서 설치까지 합시다.

참고로 맥이나 윈도우나 똑같음

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/10/%EC%BA%A1%EC%B2%984.png)

▲ 그 다음에 **작업용 폴더** 아무데나 하나 만들고

코드 에디터로 **그 폴더를 오픈해서** 코드를 짭시다.

저는 VSCode 에디터 사용할 것이고 없으면 하나 설치하면 되겠습니다.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/10/%EC%BA%A1%EC%B2%985.png)

▲ 이제 폴더 안에 server.js 파일을 하나 만들어서 서버 코드를 짤건데

그 전에 라이브러리 설치를 좀 해야합니다.

> 서버만들기 2. 라이브러리 설치

웹서버 쉽게 만들어주는 express라는 라이브러리를 설치해서 이용해봅시다.

에디터 상단에서 터미널을 오픈할 수 있는데

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/10/%EC%BA%A1%EC%B2%986.png)

우선 npm init -y 입력 후 엔터누르면 라이브러리 어떤 것들을 설치했는지 기록할 수 있는 파일을 하나 생성할 수 있습니다.

그 다음에 npm install express 입력하면 express가 설치됩니다.

그럼 라이브러리 소스코드는 node_modules 라는 폴더에 담겨있습니다.

- npm으로 하는게 안되면 하단을 참고합시다
- 에디터에서 작업폴더 오픈 안하고 입력하면 코딩인생 끝남

> 서버만들기 3. 코드작성

코딩 배우는 시간이 아니기 때문에 server.js 파일에 그대로 복붙하도록 합시다.

```jsx
const express = require("express");
const app = express();

app.listen(8080, () => {
  console.log("서버 실행중 http://localhost:8080");
});

app.get("/", (req, res) => {
  res.send("안녕");
});
```

대충 express 라이브러리를 이용해서 localhost:8080 주소에 서버를 띄워두라고 했고

누가 메인페이지로 들어오면 ‘안녕’ 이라는 글자를 보내라고 했습니다.

'안녕'이 마음에 안들면 취향따라 욕설을 적어보도록 합시다.

> 서버만들기 4. 코드실행

server.js 파일 실행하면 서버가 실행되는데

그건 터미널 열어서 node server.js 입력하면 끝입니다.

그 후에 웹브라우저 켜서 localhost:8080 이런 주소로 접속하면 여러분이 만든 웹서버를 만날 수 있습니다.

(참고) 개발할 때 코드를 수정해도 바로바로 반영되게 만들고 싶으면

터미널에 npm install -g nodemon 입력해서 라이브러리 하나 설치한 뒤에

nodemon server.js 입력으로 서버를 띄우는 경우도 있습니다.

(참고) 실제로 서버를 운영하는 경우에는 서버가 이상한 에러 때문에 죽는 경우가 많아서

그럴 때도 다시 알아서 잘 실행되도록 하려면 pm2같은 라이브러리를 설치해서 서버를 띄우는 경우들이 있습니다.

> 배포하려면

그래서 방금 서버개발 다 해봤는데 이걸 배포하고 싶으면 어떻게 합니까

AWS 이런데서 서버컴퓨터 빌려서 방금 했던 4-step 그대로 똑같이 하면 서버배포 끝입니다.

그 후에 "컴퓨터IPv4주소:8080"으로 들어가면 서버를 만날 수 있습니다.

근데 이건 단점이 있는데 1. 매우 귀찮고 2. 컴퓨터마다 환경이 달라서 의도대로 동작하지 않을 수도 있습니다.

Docker를 사용하면 내 환경과 코드를 이미지로 만들어놓을 수 있다고 했습니다.

이미지는 옮기기도 쉽고 실행도 쉽기 때문에

1. 내 환경과 코드를 이미지로 만들어놓은 다음에

2. AWS컴퓨터에 그대로 이미지를 옮겨서 실행만 하는게

훨씬 간단하고 에러도 적습니다.

**Q. 이미지는 어떻게 만들죠?**

- Dockerfile이 필요합니다.

Dockerfile은 밀키트 레시피 적는 곳인데

여기다가 **어떤 OS**를 설치해야되는지

**어떤 프로그램과 라이브러리**를 설치할건지

**어떤 터미널 명령어**를 실행할건지 다 적어놓을 수 있습니다.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%986.png)

이거저거 작성해둔 다음에 터미널에서 docker build 명령어 입력하면 여러분만의 이미지를 하나 생성할 수 있습니다.

근데 dockerfile 문법으로 적어야 해서 그건 다음 시간에 알아볼 것임

> npm으로 뭔가 입력하는게 잘 안되는 경우

- Node.js 설치된거 지우고 최근에 나온 LTS 버전으로 다시 설치해봅시다.
- 맥의 경우 sudo를 넣어서 sudo npm 어쩌구~ 입력해봅시다.
- 윈도우는 허가되지 않은 스크립트 어쩌구 에러가 나면

시작 - 검색 - powershell 검색 후 관리자모드로 실행해서

Set-ExecutionPolicy RemoteSigned 입력하고 터미널 껐다켜서 다시 시도해봅시다.

- 윈도우는 onedrive 폴더 안에 코딩하면 원래 잘 안됩니다.
- 요즘 Node.js는 한글 폴더명을 사용시 잘 안됩니다.
