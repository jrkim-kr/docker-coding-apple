# 10. Volume ì‚¬ìš©ë²•ê³¼ PostgreSQL DB ë„ìš°ê¸°

# í•µì‹¬ ì •ë¦¬

## ğŸ¯ í•™ìŠµ ëª©í‘œ

ì´ íŠœí† ë¦¬ì–¼ì„ ë§ˆì¹˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- Docker Volumeì˜ ê°œë…ê³¼ í•„ìš”ì„± ì´í•´
- PostgreSQL DBë¥¼ ì»¨í…Œì´ë„ˆë¡œ ì‹¤í–‰
- Volumeì„ ìƒì„±í•˜ê³  ì»¨í…Œì´ë„ˆì— ì¥ì°©
- ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ë³´ê´€í•˜ëŠ” ë°©ë²• ìŠµë“
- Bind Mountì™€ Volumeì˜ ì°¨ì´ì  íŒŒì•…

---

## ğŸ“š ì‚¬ì „ ì§€ì‹

- Docker ê¸°ë³¸ ëª…ë ¹ì–´ (run, exec)
- ì»¨í…Œì´ë„ˆì˜ ê°œë…
- ê°„ë‹¨í•œ í„°ë¯¸ë„ ëª…ë ¹ì–´
- (ì„ íƒ) SQL ê¸°ë³¸ ë¬¸ë²•

---

## 1ë‹¨ê³„: Volumeì´ë€?

### ì™œ Volumeì´ í•„ìš”í•œê°€ìš”?

**ë¬¸ì œ ìƒí™©:**

```
[ì»¨í…Œì´ë„ˆ ì‹¤í–‰] â†’ [ë°ì´í„° ì €ì¥] â†’ [ì»¨í…Œì´ë„ˆ ì¢…ë£Œ] â†’ ğŸ’¥ ë°ì´í„° ì‚¬ë¼ì§!

```

ì»¨í…Œì´ë„ˆëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **ì¼íšŒìš©**ì…ë‹ˆë‹¤. ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•˜ê±°ë‚˜ ì¬ì‹œì‘í•˜ë©´ ì•ˆì— ìˆë˜ ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.

**í•´ê²°ì±…: Volume**

```
[ì»¨í…Œì´ë„ˆ] â‡„ [Volume (ì˜êµ¬ ì €ì¥ì†Œ)]
     â†“
ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•´ë„ Volumeì— ë°ì´í„° ë³´ê´€ë¨

```

### Volumeì˜ ì‘ë™ ì›ë¦¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ì»¨í…Œì´ë„ˆ      â”‚
â”‚  /var/lib/...   â”‚ â† ë°ì´í„° ìƒì„±
â”‚        â†“        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ ìë™ ë³µì‚¬
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Volume        â”‚
â”‚  (ì˜êµ¬ ì €ì¥)    â”‚ â† ë°ì´í„° ë³´ì¡´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

- **ì»¨í…Œì´ë„ˆì—ì„œ ë°ì´í„° ìƒì„±** â†’ ìë™ìœ¼ë¡œ Volumeì— ë³µì‚¬
- **ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘** â†’ Volumeì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜´
- **ë°ì´í„° ì•ˆì „í•˜ê²Œ ë³´ê´€** âœ…

---

## 2ë‹¨ê³„: PostgreSQL ì´ë¯¸ì§€ ë‹¤ìš´ë°›ê¸°

### Docker Desktopì—ì„œ ë‹¤ìš´ë°›ê¸°

1. Docker Desktop ì‹¤í–‰
2. ìƒë‹¨ ê²€ìƒ‰ì°½ì— `postgres` ì…ë ¥
3. `postgres:17-alpine` ì„ íƒ (ìš©ëŸ‰ì´ ì‘ì€ ë²„ì „)
4. Pull ë²„íŠ¼ í´ë¦­

### í„°ë¯¸ë„ì—ì„œ ë‹¤ìš´ë°›ê¸°

```bash
docker pull postgres:17-alpine

```

**Alpineì´ë€?**

- ê²½ëŸ‰í™”ëœ ë¦¬ëˆ…ìŠ¤ ë°°í¬íŒ
- ìš©ëŸ‰ì´ ì‘ì•„ì„œ ë¹ ë¥´ê²Œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥
- ê¸°ë³¸ ê¸°ëŠ¥ì€ ëª¨ë‘ í¬í•¨

---

## 3ë‹¨ê³„: DB ì»¨í…Œì´ë„ˆ ì‹¤í–‰í•˜ê¸°

### í™˜ê²½ë³€ìˆ˜ë€?

í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹œ í•„ìš”í•œ ì„¤ì •ê°’ì…ë‹ˆë‹¤. DBëŠ” ë³´ì•ˆì„ ìœ„í•´ ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¥¼ **í™˜ê²½ë³€ìˆ˜**ë¡œ ë°›ìŠµë‹ˆë‹¤.

```
í™˜ê²½ë³€ìˆ˜ = í”„ë¡œê·¸ë¨ì˜ ì´ˆê¸° ì„¤ì •ê°’

```

### Docker Desktopì—ì„œ ì‹¤í–‰

1. Images íƒ­ì—ì„œ `postgres:17-alpine` ì°¾ê¸°
2. Run ë²„íŠ¼ í´ë¦­
3. Optional settings í¼ì¹˜ê¸°
4. Environment variables ì„¹ì…˜ì— ì¶”ê°€:
   - `POSTGRES_USER`: `admin`
   - `POSTGRES_PASSWORD`: `qwer1234`
5. Container name: `db-container`
6. Run ë²„íŠ¼ í´ë¦­

### ì‹¤í–‰ ëª…ë ¹ì–´ ì´í•´í•˜ê¸°

í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰í•˜ë ¤ë©´:

```bash
docker run -d --name db-container \
  -e POSTGRES_USER=admin \
  -e POSTGRES_PASSWORD=qwer1234 \
  postgres:17-alpine

```

**ê° ì˜µì…˜ ì„¤ëª…:**

- `d`: ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰ (detached mode)
- `-name db-container`: ì»¨í…Œì´ë„ˆ ì´ë¦„ ì§€ì •
- `e POSTGRES_USER=admin`: í™˜ê²½ë³€ìˆ˜ ì„¤ì • (DB ìœ ì €ëª…)
- `e POSTGRES_PASSWORD=qwer1234`: í™˜ê²½ë³€ìˆ˜ ì„¤ì • (DB ë¹„ë°€ë²ˆí˜¸)

---

## 4ë‹¨ê³„: DBì— ì ‘ì†í•˜ê¸°

### ì»¨í…Œì´ë„ˆ í„°ë¯¸ë„ ì ‘ì†

**ë°©ë²• 1: Docker Desktop ì‚¬ìš©**

1. Containers íƒ­ì—ì„œ `db-container` ì°¾ê¸°
2. ìš°ì¸¡ì˜ `Exec` íƒ­ í´ë¦­
3. í„°ë¯¸ë„ í™”ë©´ ë‚˜íƒ€ë‚¨

**ë°©ë²• 2: í„°ë¯¸ë„ ëª…ë ¹ì–´**

```bash
docker exec -it db-container /bin/sh

```

- `exec`: ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆì—ì„œ ëª…ë ¹ ì‹¤í–‰
- `it`: ì¸í„°ë™í‹°ë¸Œ í„°ë¯¸ë„ ëª¨ë“œ
- `/bin/sh`: ì‰˜(í„°ë¯¸ë„) ì‹¤í–‰

### psql ì‚¬ìš©ë²•

ì»¨í…Œì´ë„ˆ í„°ë¯¸ë„ì— ë“¤ì–´ì™”ë‹¤ë©´:

```bash
psql -U admin -W

```

- `psql`: PostgreSQL í„°ë¯¸ë„ í´ë¼ì´ì–¸íŠ¸
- `U admin`: ìœ ì €ëª… ì§€ì •
- `W`: ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í”„ë¡¬í”„íŠ¸ í‘œì‹œ

ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í›„ ì ‘ì† ì„±ê³µ!

```
psql (17.0)
Type "help" for help.

admin=#

```

### ê¸°ë³¸ psql ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª…                   | ì˜ˆì‹œ          |
| ------ | ---------------------- | ------------- |
| `\l`   | ë°ì´í„°ë² ì´ìŠ¤ ëª©ë¡ ë³´ê¸° | `\l`          |
| `\c`   | ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì†      | `\c postgres` |
| `\d`   | í…Œì´ë¸” ëª©ë¡ ë³´ê¸°       | `\d`          |
| `\dt`  | í…Œì´ë¸”ë§Œ ë³´ê¸°          | `\dt`         |
| `\q`   | psql ì¢…ë£Œ              | `\q`          |

**ë°ì´í„°ë² ì´ìŠ¤ vs í…Œì´ë¸”:**

- **ë°ì´í„°ë² ì´ìŠ¤**: í…Œì´ë¸”ì„ ë‹´ëŠ” í´ë”
- **í…Œì´ë¸”**: ì‹¤ì œ ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ” ì—‘ì…€ ì‹œíŠ¸

---

## 5ë‹¨ê³„: ë°ì´í„° ìƒì„± ë° ì¡°íšŒ

### ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì†

```sql
\c postgres

```

ê¸°ë³¸ìœ¼ë¡œ ìƒì„±ë˜ëŠ” `postgres` ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ì†í•©ë‹ˆë‹¤.

### í…Œì´ë¸” ë§Œë“¤ê¸°

```sql
CREATE TABLE product (
    title VARCHAR(100)
);

```

- `CREATE TABLE`: í…Œì´ë¸” ìƒì„± ëª…ë ¹
- `product`: í…Œì´ë¸” ì´ë¦„
- `title VARCHAR(100)`: ë¬¸ìì—´ ì»¬ëŸ¼ (ìµœëŒ€ 100ì)

**ì‹¤í–‰ ê²°ê³¼:**

```
CREATE TABLE

```

### ë°ì´í„° ì¶”ê°€í•˜ê¸°

```sql
INSERT INTO product VALUES ('shirt');
INSERT INTO product VALUES ('pants');
INSERT INTO product VALUES ('shoes');

```

- `INSERT INTO`: ë°ì´í„° ì‚½ì… ëª…ë ¹
- `VALUES`: ì‚½ì…í•  ê°’

**ì‹¤í–‰ ê²°ê³¼:**

```
INSERT 0 1

```

### ë°ì´í„° ì¡°íšŒí•˜ê¸°

```sql
SELECT * FROM product;

```

**ì‹¤í–‰ ê²°ê³¼:**

```
 title
-------
 shirt
 pants
 shoes
(3 rows)

```

---

## 6ë‹¨ê³„: Volume ìƒì„± ë° ì¥ì°©

### ë¬¸ì œ ìƒí™© ì¬í˜„

ì§€ê¸ˆê¹Œì§€ ë§Œë“  ë°ì´í„°ëŠ” ì»¨í…Œì´ë„ˆ ì•ˆì—ë§Œ ìˆìŠµë‹ˆë‹¤:

```bash
# ì»¨í…Œì´ë„ˆ ì •ì§€ ë° ì‚­ì œ
docker stop db-container
docker rm db-container

# ë‹¤ì‹œ ì‹¤í–‰
docker run -d --name db-container \
  -e POSTGRES_USER=admin \
  -e POSTGRES_PASSWORD=qwer1234 \
  postgres:17-alpine

```

ë‹¤ì‹œ ì ‘ì†í•´ì„œ í™•ì¸í•˜ë©´:

```sql
\c postgres
\d
# í…Œì´ë¸”ì´ ì—†ìŒ!

```

ğŸ’¥ **ë°ì´í„°ê°€ ëª¨ë‘ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤!**

### Volume ë§Œë“¤ê¸°

**Docker Desktopì—ì„œ:**

1. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ `Volumes` í´ë¦­
2. `Create` ë²„íŠ¼ í´ë¦­
3. Volume name: `postgres-data`

**í„°ë¯¸ë„ì—ì„œ:**

```bash
docker volume create postgres-data

```

### Volume ëª…ë ¹ì–´ ëª¨ìŒ

```bash
# Volume ìƒì„±
docker volume create ë³¼ë¥¨ì´ë¦„

# Volume ëª©ë¡ ë³´ê¸°
docker volume ls

# Volume ìƒì„¸ ì •ë³´
docker volume inspect ë³¼ë¥¨ì´ë¦„

# Volume ì‚­ì œ
docker volume rm ë³¼ë¥¨ì´ë¦„

```

### Volumeê³¼ í•¨ê»˜ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

```bash
docker run -d --name db-container \
  -e POSTGRES_USER=admin \
  -e POSTGRES_PASSWORD=qwer1234 \
  -v postgres-data:/var/lib/postgresql/data \
  postgres:17-alpine

```

**ìƒˆë¡œìš´ ì˜µì…˜:**

- `v postgres-data:/var/lib/postgresql/data`
  - `postgres-data`: Volume ì´ë¦„
  - `/var/lib/postgresql/data`: PostgreSQLì´ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ê²½ë¡œ

**ë‹¤ë¥¸ DBì˜ ë°ì´í„° ê²½ë¡œ:**

- MySQL: `/var/lib/mysql`
- MongoDB: `/data/db`
- Redis: `/data`

---

## 7ë‹¨ê³„: ë°ì´í„° ì˜ì†ì„± í™•ì¸

### ë°ì´í„° ë‹¤ì‹œ ìƒì„±

```bash
# ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it db-container /bin/sh

# psql ì ‘ì†
psql -U admin -W

```

```sql
-- ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì†
\c postgres

-- í…Œì´ë¸” ìƒì„±
CREATE TABLE product (
    id SERIAL PRIMARY KEY,
    title VARCHAR(100),
    price INT
);

-- ë°ì´í„° ì¶”ê°€
INSERT INTO product (title, price) VALUES ('shirt', 25000);
INSERT INTO product (title, price) VALUES ('pants', 35000);

-- í™•ì¸
SELECT * FROM product;

```

**ì‹¤í–‰ ê²°ê³¼:**

```
 id | title | price
----+-------+-------
  1 | shirt | 25000
  2 | pants | 35000

```

### ì»¨í…Œì´ë„ˆ ì‚­ì œ í›„ ì¬ì‹¤í–‰

```bash
# ì»¨í…Œì´ë„ˆ ì •ì§€ ë° ì‚­ì œ
docker stop db-container
docker rm db-container

# ê°™ì€ Volumeìœ¼ë¡œ ë‹¤ì‹œ ì‹¤í–‰
docker run -d --name db-container \
  -e POSTGRES_USER=admin \
  -e POSTGRES_PASSWORD=qwer1234 \
  -v postgres-data:/var/lib/postgresql/data \
  postgres:17-alpine

```

### ë°ì´í„° í™•ì¸

```bash
docker exec -it db-container /bin/sh
psql -U admin -W

```

```sql
\c postgres
SELECT * FROM product;

```

**ê²°ê³¼:**

```
 id | title | price
----+-------+-------
  1 | shirt | 25000
  2 | pants | 35000

```

âœ… **ë°ì´í„°ê°€ ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤!**

---

## 8ë‹¨ê³„: Bind Mount ì´í•´í•˜ê¸°

### Volume vs Bind Mount

| íŠ¹ì§•      | Volume               | Bind Mount       |
| --------- | -------------------- | ---------------- |
| ê´€ë¦¬ ì£¼ì²´ | Docker               | ì‚¬ìš©ì           |
| ì €ì¥ ìœ„ì¹˜ | Docker ê´€ë¦¬ í´ë”     | ë‚´ê°€ ì§€ì •í•œ í´ë” |
| ê²½ë¡œ      | ìë™ ìƒì„±            | ì§ì ‘ ì§€ì •        |
| ì‚¬ìš© ìš©ë„ | ì¼ë°˜ì ì¸ ë°ì´í„° ë³´ê´€ | ê°œë°œ/ë””ë²„ê¹…      |

### Bind Mount ì‚¬ìš©ë²•

```bash
docker run -d --name db-container \
  -e POSTGRES_USER=admin \
  -e POSTGRES_PASSWORD=qwer1234 \
  -v /Users/myname/db-data:/var/lib/postgresql/data \
  postgres:17-alpine

```

- `/Users/myname/db-data`: ë‚´ ì»´í“¨í„°ì˜ ì‹¤ì œ í´ë” ê²½ë¡œ
- ì´ í´ë”ì— DB ë°ì´í„°ê°€ ì§ì ‘ ì €ì¥ë¨

### ì–¸ì œ Bind Mountë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”?

**Volume ì‚¬ìš© (ê¶Œì¥):**

- ìš´ì˜ í™˜ê²½ì˜ DB
- ìë™ ë°±ì—… ì‹œìŠ¤í…œ êµ¬ì¶•
- Dockerê°€ ì•Œì•„ì„œ ê´€ë¦¬

**Bind Mount ì‚¬ìš©:**

- ê°œë°œ ì¤‘ ì½”ë“œ ë³€ê²½ì‚¬í•­ ì¦‰ì‹œ ë°˜ì˜
- ë¡œê·¸ íŒŒì¼ ì§ì ‘ í™•ì¸
- íŠ¹ì • ìœ„ì¹˜ì— ë°ì´í„° ë³´ê´€ í•„ìš”

---

## ğŸ“ í•µì‹¬ ìš”ì•½

### Volumeì˜ í•„ìš”ì„±

```
ì»¨í…Œì´ë„ˆ = íœ˜ë°œì„± (ë°ì´í„° ì‚¬ë¼ì§)
Volume = ì˜ì†ì„± (ë°ì´í„° ë³´ì¡´)

```

### ì‹¤ìŠµ ìˆœì„œ ë³µìŠµ

1. **DB ì´ë¯¸ì§€ ë‹¤ìš´** â†’ `postgres:17-alpine`
2. **í™˜ê²½ë³€ìˆ˜ ì„¤ì •** â†’ ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸
3. **ì»¨í…Œì´ë„ˆ ì‹¤í–‰** â†’ DB ì„œë²„ ì‹œì‘
4. **psql ì ‘ì†** â†’ DB ì¡°ì‘
5. **Volume ìƒì„±** â†’ ë°ì´í„° ì €ì¥ì†Œ
6. **Volume ì¥ì°©** â†’ `v` ì˜µì…˜ ì‚¬ìš©
7. **ì˜ì†ì„± í™•ì¸** â†’ ì»¨í…Œì´ë„ˆ ì‚­ì œ í›„ ì¬ì‹¤í–‰

### í•µì‹¬ ëª…ë ¹ì–´

```bash
# Volume ìƒì„±
docker volume create postgres-data

# Volumeê³¼ í•¨ê»˜ ì‹¤í–‰
docker run -v postgres-data:/var/lib/postgresql/data postgres:17-alpine

# ì»¨í…Œì´ë„ˆ í„°ë¯¸ë„ ì ‘ì†
docker exec -it ì»¨í…Œì´ë„ˆëª… /bin/sh

# DB ì ‘ì†
psql -U admin -W

```

---

## ğŸ’¡ ì‹¤ì „ íŒ

### 1. Volume ë°±ì—…í•˜ê¸°

Volume ë‚´ìš©ì„ ì••ì¶• íŒŒì¼ë¡œ ë°±ì—…:

```bash
docker run --rm -v postgres-data:/data -v $(pwd):/backup \
  alpine tar czf /backup/backup.tar.gz -C /data .

```

### 2. Volume ë³µì›í•˜ê¸°

ë°±ì—… íŒŒì¼ì—ì„œ Volume ë³µì›:

```bash
docker run --rm -v postgres-data:/data -v $(pwd):/backup \
  alpine tar xzf /backup/backup.tar.gz -C /data

```

### 3. ì‹¤ì œ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ”?

**ì»¨í…Œì´ë„ˆ DBì˜ ì¥ë‹¨ì :**

**ì¥ì :**

- âœ… ë¹ ë¥¸ í™˜ê²½ êµ¬ì¶•
- âœ… í…ŒìŠ¤íŠ¸/ê°œë°œ í™˜ê²½ êµ¬ì¶• ìš©ì´
- âœ… ë²„ì „ ê´€ë¦¬ ì‰¬ì›€

**ë‹¨ì :**

- âš ï¸ ì•ˆì •ì„± ë¬¸ì œ
- âš ï¸ ë°±ì—… ê´€ë¦¬ ë³µì¡
- âš ï¸ ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ

**ê¶Œì¥ ì‚¬í•­:**

- **ê°œë°œ/í…ŒìŠ¤íŠ¸**: ì»¨í…Œì´ë„ˆ DB ì‚¬ìš©
- **ìš´ì˜ í™˜ê²½**: ê´€ë¦¬í˜• DB ì„œë¹„ìŠ¤ ì‚¬ìš© (AWS RDS, Google Cloud SQL ë“±)

### 4. Node.jsì—ì„œ PostgreSQL ì—°ê²°

```jsx
const { Pool } = require("pg");

const pool = new Pool({
  host: "localhost", // ë˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¦„
  database: "postgres",
  user: "admin",
  password: "qwer1234",
  port: 5432,
});

// ì¿¼ë¦¬ ì‹¤í–‰
app.get("/products", async (req, res) => {
  try {
    const result = await pool.query("SELECT * FROM product");
    res.json(result.rows);
  } catch (err) {
    console.error(err);
    res.status(500).send("Database error");
  }
});
```

---

## ğŸ’ª ì—°ìŠµ ë¬¸ì œ

### ê¸°ì´ˆ ë¬¸ì œ

1. **Volume ìƒì„±í•˜ê¸°**
   - `my-test-volume`ì´ë¼ëŠ” ì´ë¦„ì˜ Volumeì„ ìƒì„±í•˜ì„¸ìš”
2. **DB ì»¨í…Œì´ë„ˆ ì‹¤í–‰**
   - PostgreSQLì„ Volumeê³¼ í•¨ê»˜ ì‹¤í–‰í•˜ì„¸ìš”
   - í¬íŠ¸ë¥¼ 5432:5432ë¡œ ë§¤í•‘í•˜ì„¸ìš”
3. **í…Œì´ë¸” ìƒì„± ë° ë°ì´í„° ì…ë ¥**
   - `users` í…Œì´ë¸”ì„ ë§Œë“œì„¸ìš” (id, name, email)
   - 3ëª…ì˜ ì‚¬ìš©ì ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ì„¸ìš”

### ì‹¬í™” ë¬¸ì œ

1. **ì˜ì†ì„± í…ŒìŠ¤íŠ¸**
   - ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì‹¤í–‰
   - ë°ì´í„°ê°€ ìœ ì§€ë˜ëŠ”ì§€ í™•ì¸
2. **Bind Mount ì‹¤ìŠµ**
   - ë‚´ ì»´í“¨í„°ì˜ íŠ¹ì • í´ë”ë¥¼ Bind Mountë¡œ ì—°ê²°
   - í•´ë‹¹ í´ë”ì— DB íŒŒì¼ì´ ìƒì„±ë˜ëŠ”ì§€ í™•ì¸
3. **ì—¬ëŸ¬ í…Œì´ë¸” ë§Œë“¤ê¸°**
   - `orders` í…Œì´ë¸” ìƒì„± (order_id, user_id, product_id, quantity)
   - `users`ì™€ `orders`ë¥¼ JOINí•˜ëŠ” ì¿¼ë¦¬ ì‘ì„±

### ì •ë‹µ ì˜ˆì‹œ

**ë¬¸ì œ 1-3 ì •ë‹µ:**

```bash
# 1. Volume ìƒì„±
docker volume create my-test-volume

# 2. ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d --name my-postgres \
  -e POSTGRES_USER=admin \
  -e POSTGRES_PASSWORD=qwer1234 \
  -p 5432:5432 \
  -v my-test-volume:/var/lib/postgresql/data \
  postgres:17-alpine

# 3. ì ‘ì† ë° í…Œì´ë¸” ìƒì„±
docker exec -it my-postgres /bin/sh
psql -U admin -W

```

```sql
-- ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì†
\c postgres

-- í…Œì´ë¸” ìƒì„±
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    email VARCHAR(100)
);

-- ë°ì´í„° ì…ë ¥
INSERT INTO users (name, email) VALUES
    ('ê¹€ì² ìˆ˜', 'kim@example.com'),
    ('ì´ì˜í¬', 'lee@example.com'),
    ('ë°•ë¯¼ìˆ˜', 'park@example.com');

-- í™•ì¸
SELECT * FROM users;

```

**ë¬¸ì œ 6 ì •ë‹µ:**

```sql
-- orders í…Œì´ë¸” ìƒì„±
CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    user_id INT,
    product_id INT,
    quantity INT
);

-- ìƒ˜í”Œ ë°ì´í„°
INSERT INTO orders (user_id, product_id, quantity) VALUES
    (1, 101, 2),
    (2, 102, 1),
    (1, 103, 5);

-- JOIN ì¿¼ë¦¬
SELECT u.name, u.email, o.order_id, o.quantity
FROM users u
JOIN orders o ON u.id = o.user_id;

```

---

## ğŸ“Œ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)

**Q: Volumeì„ ì‚­ì œí•˜ë©´ ë°ì´í„°ë„ ì‚¬ë¼ì§€ë‚˜ìš”?**

- A: ë„¤, Volumeì„ ì‚­ì œí•˜ë©´ ì•ˆì— ìˆë˜ ëª¨ë“  ë°ì´í„°ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤. ì£¼ì˜í•˜ì„¸ìš”!

**Q: í•˜ë‚˜ì˜ Volumeì„ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆê°€ ê³µìœ í•  ìˆ˜ ìˆë‚˜ìš”?**

- A: ë„¤, ê°€ëŠ¥í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆê°€ ê°™ì€ Volumeì„ ì½ê³  ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Q: Volumeì˜ ì‹¤ì œ ì €ì¥ ìœ„ì¹˜ëŠ” ì–´ë””ì¸ê°€ìš”?**

- A: Docker Desktopì˜ ê²½ìš° ê°€ìƒ ë¨¸ì‹  ë‚´ë¶€ì— ì €ì¥ë©ë‹ˆë‹¤. `docker volume inspect` ëª…ë ¹ìœ¼ë¡œ ê²½ë¡œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Q: DB ì»¨í…Œì´ë„ˆ í¬íŠ¸ë¥¼ ì™¸ë¶€ì— ë…¸ì¶œí•˜ì§€ ì•Šì•„ë„ ë˜ë‚˜ìš”?**

- A: ë„¤, ê°™ì€ Docker Network ë‚´ì—ì„œë§Œ í†µì‹ í•œë‹¤ë©´ í¬íŠ¸ ë°”ì¸ë”©ì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤. ë³´ì•ˆìƒ ë” ì•ˆì „í•©ë‹ˆë‹¤.

# ê°•ì˜ ìŠ¤í¬ë¦½íŠ¸

Volume ì‚¬ìš©ë²•ì„ ë°°ì›Œë³¼ ê²ƒì¸ë° ë°ì´í„°ë² ì´ìŠ¤(DB)ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ì‹¤í–‰í•´ë³´ë©´ì„œ ë‹¤ë¤„ë´…ì‹œë‹¤.

DBë„ ì§ì ‘ ì„¤ì¹˜í•˜ê³  ì‹¤í–‰í•˜ê³  ê·¸ëŸ° ë°©ë²•ì„ ì•Œë©´

ì§ì ‘ Dockerfile ì‘ì„±í•´ì„œ ì´ë¯¸ì§€ë¡œ ë§Œë“¤ì–´ì„œ ë„ì›Œë„ ë˜ê¸´ í•˜ëŠ”ë°

ê·¼ë° DBëŠ” ë”±íˆ ì„¤ì •í• ê²Œ ì—†ìœ¼ë©´ ì§ì ‘ ì´ë¯¸ì§€ë¡œ ë§Œë“¤ í•„ìš”ëŠ” ì—†ê³ 

ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ ê³µì‹ DBÂ ì´ë¯¸ì§€ ê°™ì€ê±° ì‹¤í–‰ë§Œ í•´ë„ ì‰½ê²Œ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> PostgreSQL ì´ë¯¸ì§€ ë‹¤ìš´ë°›ê¸°

ìš”ì¦˜ ì¸ê¸°ìˆëŠ” PostgreSQLì„ ì¨ë´…ì‹œë‹¤.

ì—‘ì…€ì²˜ëŸ¼ í…Œì´ë¸”ì— ìë£Œë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤.

ê·¸ëŸ¬ê¸° ìœ„í•´ì„œ docker desktop ìƒë‹¨ì—ì„œ postgres ê²€ìƒ‰í•´ì„œ ì›í•˜ëŠ” ì´ë¯¸ì§€ ë‹¤ìš´ë°›ì•„ì˜µì‹œë‹¤.

ì €ëŠ” postgres:17-alpine ì´ëŸ°ê±° ë‹¤ìš´ë°›ì•„ì™”ìŠµë‹ˆë‹¤.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%984-4.png)

â–² ê·¼ë° DBëŠ” ì‹¤í–‰í•  ë•Œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì±„ì›Œì„œ ì¢€ ì‹¤í–‰í•´ì•¼í•©ë‹ˆë‹¤.

ìœ„ì²˜ëŸ¼ DB ì ‘ì†ìš© ì•„ì´ë””/ë¹„ë²ˆì„ í™˜ê²½ë³€ìˆ˜ë¡œ ì±„ì›Œì•¼í•©ë‹ˆë‹¤.

í¬íŠ¸ë°”ì¸ë”©ì€ í•˜ê³ ì‹¶ìœ¼ë©´ í•©ì‹œë‹¤.

```
docker run -d --name db-container -e POSTGRES_USER=admin -e POSTGRES_PASSWORD=qwer1234 postgres:17-alpine
```

ì´ê±°ë§ê³  í„°ë¯¸ë„ì—ë‹¤ê°€ ì…ë ¥í•˜ê³  ì‹¶ìœ¼ë©´ ì´ë ‡ê²Œ í•©ì‹œë‹¤.

ëª…ë ¹ì–´ê°€ ê¸¸ê³  ë”ëŸ¬ìš´ë° ë‚˜ì¤‘ì— docker composeë¥¼ ë°°ìš°ë©´ ë§¤ë²ˆ ëª…ë ¹ì–´ ê¸¸ê²Œ ì…ë ¥ì•ˆí•´ë„ ë©ë‹ˆë‹¤.

> DB ì ‘ì†í•´ë³´ê¸°

DBì— ì ‘ì†í•˜ë ¤ë©´ DBeaverê°™ì€ í”„ë¡œê·¸ë¨ ì“°ë©´ ì¢€ ë¹„ì£¼ì–¼ì ìœ¼ë¡œ ì‰½ê²Œ ì ‘ì†í•´ë³¼ ìˆ˜ ìˆê³ 

ì•„ë‹ˆë©´ ì›¹ì„œë²„ì—ì„œ DBì ‘ì†í•´ë³¼ ìˆ˜ë„ ìˆê³ 

ë‹¤ ê·€ì°®ìœ¼ë©´ í„°ë¯¸ë„ì—ì„œ DBì ‘ì†ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

psqlì´ë¼ëŠ” í”„ë¡œê·¸ë¨ì´ ì•„ë§ˆ í•¨ê»˜ ì„¤ì¹˜ë  ê²ƒì´ê¸° ë•Œë¬¸ì— ê·¸ê±° ì“°ë©´Â **í„°ë¯¸ë„ì—ì„œ DBì¡°ì‘**ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```python
docker exec -it ì»¨í…Œì´ë„ˆì´ë¦„ /bin/sh
```

ì¼ë‹¨ DB ì»¨í…Œì´ë„ˆ í„°ë¯¸ë„ë¡œ ë“¤ì–´ê°€ë´…ì‹œë‹¤.

ìœ„ ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì— ì…ë ¥í•˜ê±°ë‚˜

docker desktopì—ì„œ DB ì»¨í…Œì´ë„ˆì˜ exec ë©”ë‰´ë¡œ ë“¤ì–´ê°€ë©´ ë˜ê² ìŠµë‹ˆë‹¤.

> psqlë¡œ DB ë‹¤ë£¨ê¸°

psqlì€ í„°ë¯¸ë„ì—ì„œ DBë¥¼ ì¡°ì‘í•´ë³¼ ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤.

```
psql -U admin -W
```

PostgreSQL DB ì„¤ì¹˜ëœ ì»¨í…Œì´ë„ˆ í„°ë¯¸ë„ì— ì…ë ¥í•˜ë©´ DB ì ‘ì†ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

adminìë¦¬ì—ëŠ” ì—¬ëŸ¬ë¶„ë“¤ DBì ‘ì†ìš©ì•„ì´ë”” ì…ë ¥í•˜ê³  -WëŠ” ë¹„ë²ˆ í™•ì¸í•˜ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ë¹„ë²ˆ ì…ë ¥í•˜ë¼ëŠ”ë° ì—¬ëŸ¬ë¶„ì´ ì„¤ì •í•œ ë¹„ë²ˆ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ DBì— ì ‘ì†ë©ë‹ˆë‹¤.

**\l**Â ì…ë ¥í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì—¬ê¸°ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¼ê³  ë¶€ë¥´ëŠ”ê±´ í…Œì´ë¸”ì„ ë‹´ì•„ë†“ëŠ” ì¼ì¢…ì˜ í´ë”ì…ë‹ˆë‹¤.

**\c ë°ì´í„°ë² ì´ìŠ¤ëª…**Â ëˆ„ë¥´ë©´ ê±°ê¸°ë¡œ ì ‘ì†í•  ìˆ˜ ìˆê³ 

**\d**Â ëˆ„ë¥´ë©´ ê·¸ ì•ˆì— ìˆëŠ” í…Œì´ë¸”ë“¤ì„ êµ¬ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í…Œì´ë¸”ì€ ì—‘ì…€íŒŒì¼í•˜ë‚˜ì…ë‹ˆë‹¤.

ì´ì œ í…Œì´ë¸” í•˜ë‚˜ ë§Œë“¤ì–´ì„œ ê±°ê¸°ë‹¤ê°€ SQL ë¬¸ë²•ìœ¼ë¡œ ë°ì´í„° ì €ì¥í•˜ê³  ê·¸ëŸ´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> ë°ì´í„°ëŠ” volume ì¨ì•¼ ìœ ì§€ê°€ëŠ¥

ì»¨í…Œì´ë„ˆë¡œ DBë¥¼ ë„ìš°ë©´ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.

ì»¨í…Œì´ë„ˆë¥¼ ê»ë‹¤ì¼œë©´ í•­ìƒ ì•ˆì— ìˆë˜ ë‚´ìš©ì´ ì´ˆê¸°í™”ë˜ê¸° ë•Œë¬¸ì— DBì— ìˆë˜ ë°ì´í„°ë„ ë‹¹ì—°íˆ ë‚ ë¼ê°‘ë‹ˆë‹¤.

ê»ë‹¤ì¼œë„ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ê³  ì‹¶ìœ¼ë©´Â **ë°ì´í„°ë¥¼Â volumeì— ë³µì‚¬**í•´ë‘ë©´ ë©ë‹ˆë‹¤.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%985-2.png)

â–² Docker desktop ì™¼ìª½ë©”ë‰´ë³´ë©´ volume ë©”ë‰´ê°€ ìˆëŠ”ë° ì—¬ê¸°ì„œ ë³¼ë¥¨ì„ í•˜ë‚˜ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë³¼ë¥¨ì´ ë­ëƒë©´ "ì»¨í…Œì´ë„ˆì—ì„œ ë°œìƒí•œ ë°ì´í„°ë¥¼ ë°±ì—…í•´ë‘˜ í´ë”"ì…ë‹ˆë‹¤.

ì‹¤ì€ ê·¸ëƒ¥ í•˜ë“œë””ìŠ¤í¬ì— í´ë”í•˜ë‚˜ ë§Œë“œëŠ”ê±°ë‘ ë˜‘ê°™ìŠµë‹ˆë‹¤. ê·¼ë° dockerì—ì„œ ê´€ë¦¬í•´ì£¼ëŠ” í´ë”ì¼ ë¿ì„

```lua
docker volume create ë³¼ë¥¨ì´ë¦„
docker volume ls
docker volume inspect ë³¼ë¥¨ì´ë¦„
docker volume rm ë³¼ë¥¨ì´ë¦„
```

í„°ë¯¸ë„ì—ì„œ ë³¼ë¥¨ ìƒì„±, ì‚­ì œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

ì°¨ë¡€ë¡œ ë³¼ë¥¨ ìƒì„±, ëª©ë¡, ìƒì„¸ë³´ê¸°, ì‚­ì œ ëª…ë ¹ì–´ì…ë‹ˆë‹¤.

ë³¼ë¥¨ì„ ë§Œë“¤ì–´ë†¨ìœ¼ë©´ ì´ì œ ì»¨í…Œì´ë„ˆ ë°ì´í„°ë¥¼ ë„ìš¸ ë•Œ ì´ ë³¼ë¥¨ì„ ì¥ì°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ê·¸ëŸ¬ë©´ ì»¨í…Œì´ë„ˆì— ìˆë˜ ë°ì´í„°ëŠ” ìë™ìœ¼ë¡œ ë³¼ë¥¨ìœ¼ë¡œ ë³µì‚¬ë˜ê³ 
- ë‚˜ì¤‘ì— ì»¨í…Œì´ë„ˆ ë„ìš¸ ë•Œ ë³¼ë¥¨ì— ìˆë˜ ë°ì´í„°ë¥¼ ì»¨í…Œì´ë„ˆì— ì§‘ì–´ë„£ì–´ì„œ ë„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì œ ì»¨í…Œì´ë„ˆì— ìˆë˜ ë°ì´í„° ì˜êµ¬ë³´ê´€ì´ ê°€ëŠ¥í•´ì§€ê² êµ°ìš”.

> volume ì¥ì°©í•´ì„œ DB ì»¨í…Œì´ë„ˆ ë„ìš°ê¸°

```ruby
docker run -v ë³¼ë¥¨ì´ë¦„:/var/lib/postgresql/data posgres:17-alpine
```

ì»¨í…Œì´ë„ˆì— ë³¼ë¥¨ì„ ì¥ì°©í•˜ë ¤ë©´ ì»¨í…Œì´ë„ˆ ë„ìš¸ ë•Œ -v ëª…ë ¹ì–´ ì“°ë©´ ë©ë‹ˆë‹¤.

- eë¡œ í™˜ê²½ë³€ìˆ˜ ì§‘ì–´ë„£ëŠ”ê±´ ì•Œì•„ì„œ í•´ë´…ì‹œë‹¤.

ê·¸ë¦¬ê³  ì»¨í…Œì´ë„ˆ ì•ˆì— ìˆëŠ” ì–´ë–¤ í´ë”ë¥¼ ë³¼ë¥¨ì— ë³µì‚¬í•´ë‘˜ê±´ì§€ ê²½ë¡œë„ ë§˜ëŒ€ë¡œ ì •í•˜ë©´ ë©ë‹ˆë‹¤.

PostgreSQLì˜ ê²½ìš° /var/lib/postgresql/data ì´ëŸ° í´ë”ì— DBë°ì´í„°ë¥¼ ì €ì¥í•´ë‘ê¸° ë•Œë¬¸ì—

ê·¸ê±¸ ë³¼ë¥¨ì— ë³µì‚¬í•˜ë¼ê³  í•˜ë©´ ë©ë‹ˆë‹¤.

MySQLì„ ì“°ëŠ” ê²½ìš° /var/lib/mysql ì´ëŸ° í´ë”ì— DB ë°ì´í„°ë¥¼ ì €ì¥í•´ë‘ê¸° ë•Œë¬¸ì—

ê·¸ê±¸ ë³¼ë¥¨ì— ë³µì‚¬í•˜ë¼ê³  í•˜ë©´ ë©ë‹ˆë‹¤.

ì´ëŸ°ê±´ DBMS ì¢…ë¥˜ë§ˆë‹¤ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ì°¾ì•„ì„œ ì”ë‹ˆë‹¤.

> ë³¼ë¥¨ì— ë°ì´í„° ì €ì¥ë˜ë‚˜ í™•ì¸í•´ë³´ì

DBë°ì´í„°ê°€ ì§„ì§œë¡œ ë³¼ë¥¨ì— ë³µì‚¬ë˜ë‚˜ í™•ì¸í•´ë´…ì‹œë‹¤.

ê·¸ëŸ¬ê¸° ìœ„í•´ì„œ DB ì»¨í…Œì´ë„ˆ ì ‘ì†í•´ì„œ í…Œì´ë¸”ì— ë°ì´í„° ëª‡ê°œ ì§‘ì–´ë„£ì–´ë´…ì‹œë‹¤.

ë°©ê¸ˆë„ìš´ ì»¨í…Œì´ë„ˆ í„°ë¯¸ë„ì— ì ‘ì†í•˜ê³ 

**psql -U admin -W**Â ì´ê±¸ë¡œ psql ì¼ ë‹¤ìŒì—

**\l**Â í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ ëª©ë¡ ì¡°íšŒí•´ë³´ê³ 

**\c postgres**Â ì´ê±¸ë¡œ ì¨ì„œ ì•„ë¬´ ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ë“¤ì–´ê°€ë³´ê³ 

ì´ì œ ì—¬ê¸°ë‹¤ê°€ SQL ë¬¸ë²•ì„ ì¢€ ì§œì„œ í…Œì´ë¸”ì„ ìƒì„±í•˜ê³  ê±°ê¸°ë‹¤ê°€ ë°ì´í„°ë„ í•˜ë‚˜ ë„£ì–´ë´…ì‹œë‹¤.

```sql
CREATE TABLE product ( title VARCHAR(100) );
INSERT INTO product VALUES ('shirt');
SELECT * FROM product;
```

ì°¨ë¡€ë¡œ í…Œì´ë¸” ë§Œë“¤ê¸°, í…Œì´ë¸”ì— í–‰ ì§‘ì–´ë„£ê¸°, í…Œì´ë¸” ì¶œë ¥í•˜ê¸° SQL ë¬¸ë²•ì…ë‹ˆë‹¤.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%988-1.png)

â–² ì§€ê¸ˆ DBì— ë§Œë“ ê±¸ ê·¸ë¦¼ìœ¼ë¡œ ë³´ìë©´ ì´ëŸ° ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ í•˜ë‚˜ ì €ì¥í•´ë´¤ëŠ”ë°

ë³¼ë¥¨ì„ ì¥ì°©í–ˆì„ ê²½ìš°Â **ì´ ë°ì´í„°ê°€ ë³¼ë¥¨ì—ë„ ë³µì‚¬ë©ë‹ˆë‹¤.**

ì´ì œ ì»¨í…Œì´ë„ˆë¥¼ ì•„ì˜ˆ ì‚­ì œí–ˆë‹¤ê°€ ë‹¤ì‹œ ë„ì›Œë„ ê°™ì€Â ë³¼ë¥¨ë§Œ ì˜ ì¥ì°©í•˜ë©´ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ë°

ë‚¨ì˜ ë§ ë¯¿ì§€ ë§ê³  ì§„ì§ ì§€ í™•ì¸í•˜ë ¤ë©´

ì§ì ‘ ì»¨í…Œì´ë„ˆ ì§€ì› ë‹¤ê°€ ë‹¤ì‹œ ë³¼ë¥¨ë„£ì–´ì„œ ë„ì›Œë³´ì‹œë©´ ë˜ê² ìŠµë‹ˆë‹¤.

ê·¸ ë‹¤ìŒì— ë°ì´í„° ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆëŠ”ì§€ psqlë¡œ ë°ì´í„°ë² ì´ìŠ¤ì™€ í…Œì´ë¸” ì ‘ì†í•´ì„œ SQL ë¬¸ë²•ìœ¼ë¡œ ì¶œë ¥ë„ í•´ë´…ì‹œë‹¤.

> bind mount

ë³¼ë¥¨ì€ dockerì—ì„œ ê´€ë¦¬í•´ì£¼ëŠ” í´ë”ê°™ì€ ê°œë…ì…ë‹ˆë‹¤.

dockerê°€ ê´€ë¦¬í•´ì£¼ëŠ”ê²Œ ì‹«ìœ¼ë©´Â **ì—¬ëŸ¬ë¶„ì´ ì»´í“¨í„°ì— ë§Œë“¤ì–´ë‘” í´ë”ë¥¼**Â ë³¼ë¥¨ìœ¼ë¡œ ì¥ì°©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ì–´ë–»ê²Œ í•˜ëƒë©´ volume ë§Œë“¤ ë•Œ ì—¬ëŸ¬ë¶„ ë¡œì»¬ í´ë” ê²½ë¡œ ì§‘ì–´ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.

```coffeescript
docker run -v /ë‚´ì»´í“¨í„°í´ë”ê²½ë¡œ:/ì»¨í…Œì´ë„ˆê²½ë¡œ ì´ë¯¸ì§€ëª…
```

ì´ëŸ¬ë©´ ë‚´ í´ë”ì— ìˆë˜ ë°ì´í„°ë“¤ì„ ë³¼ë¥¨ìœ¼ë¡œ ì¥ì°©í•´ì¤ë‹ˆë‹¤.

ì´ê±¸ bind mountë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

ë‚´ê°€ ì´ ë°ì´í„°ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ë°±ì—…í•´ì•¼ë˜ëŠ” ê²½ìš°ì—ëŠ” bind mount ë°©ì‹ìœ¼ë¡œ ì“°ëŠ”ê²Œ ë‚˜ì¤‘ì— ë°ì´í„° ì°¾ì„ ë•Œ í¸ë¦¬í•  ìˆ˜ë„ ìˆê¸´ í•©ë‹ˆë‹¤.

í•˜ì§€ë§Œ ì‹¤ì œ ë°±ì—…ì„ í•´ì•¼ëœë‹¤ë©´ ì§ì ‘ ì†ìœ¼ë¡œ í•˜ëŠ” ê²ƒ ë³´ë‹¤ëŠ”

ë³¼ë¥¨ì„ ì¥ì°©í•´ì„œ ê±°ê¸° ë‚´ìš©ì„ ì••ì¶•í•´ì„œ AWSì´ëŸ°ë° ì—…ë¡œë“œí•˜ëŠ” ë³„ë„ì˜ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•´ë†“ìœ¼ì…”ë„ ë˜ê¸´ í•©ë‹ˆë‹¤.

ì•„ë‹ˆë©´ ê·¸ëŸ° ë°±ì—… ì—­í• ì˜ ì´ë¯¸ì§€ë¥¼ ëˆ„ê°€ ì´ë¯¸ ë§Œë“¤ì–´ë‘” ê²ƒë„ ë§ê³ 

ê·¸ëŸ°ê±° ì‹¤í–‰ë§Œ í•´ë‘ë©´ ì•Œì•„ì„œ ì£¼ê¸°ì ìœ¼ë¡œ ë³¼ë¥¨ì„ ê°€ì ¸ì™€ì„œ AWSì´ëŸ°ë° ë°±ì—…í•´ì£¼ë‹ˆê¹Œ ê·¸ëŸ°ê±° ëŒë ¤ë‘ì…”ë„ ë©ë‹ˆë‹¤.

https://github.com/offen/docker-volume-backup

**ì˜¤ëŠ˜ì˜ ê²°ë¡ :**

ì»¨í…Œì´ë„ˆ ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ë³´ì¡´í•´ì•¼ëœë‹¤ë©´ ë³¼ë¥¨ì„ ë§Œë“¤ì–´ì„œ ì¥ì°©í•´ë´…ì‹œë‹¤.

ê·¸ëŸ¼ ì»¨í…Œì´ë„ˆ ë°ì´í„°ëŠ” ë³¼ë¥¨ì— ìë™ìœ¼ë¡œ ë³µì‚¬ë˜ê³ 

ë‚˜ì¤‘ì— ì»¨í…Œì´ë„ˆ ë„ìš¸ ë•Œ ë³¼ë¥¨ì— ìˆë˜ ë‚´ìš©ì„ ì»¨í…Œì´ë„ˆì— ì§‘ì–´ë„£ì–´ì„œ ë„ìš¸ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ê·¸ë˜ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆ ë„ìš¸ ë•Œ ìœ ìš©í•œë°

í•˜ì§€ë§Œ ì»¨í…Œì´ë„ˆëŠ” ì‰½ê²Œ ë„ìš°ê³ , ì‰½ê²Œ êµì²´í•˜ê³ , ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì˜®ê¸°ê³  ì´ëŸ°ê²Œ ì¥ì ì¸ë°

ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê·¸ëŸ° ê²ƒ ë³´ë‹¤ ì•ˆì •ì„±ì´ ì¤‘ìš”í•´ì„œ

ì‹¤ì€ ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì»¨í…Œì´ë„ˆë¡œ ë§Œë“¤ì–´ì„œ ë„ìš°ëŠ” ê²½ìš°ê°€ ë§ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.

ë”°ë¡œ ë°ì´í„°ë² ì´ìŠ¤ í˜¸ìŠ¤íŒ…ì„ ë°›ì•„ì„œ ê±°ê¸°ì„œ ì•ˆì „í•˜ê²Œ ë°ì´í„°ë“¤ì„ ê´€ë¦¬í•˜ëŠ”ê²Œ ë‚˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì°¸ê³ ë¡œ ì„œë²„ì—ì„œ PostgreSQLì— ì ‘ì†í•´ì„œ ì´ê±°ì €ê±° SQL ì‹¤í–‰í•˜ë ¤ë©´**

1. í„°ë¯¸ë„ì—ì„œ npm install pg ì…ë ¥í•´ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜í•˜ê³ 

```jsx
const { Pool } = require("pg");
const pool = new Pool({
  host: "db", //DBì»¨í…Œì´ë„ˆì´ë¦„database: 'postgres',//ì ‘ì†í• Databaseì´ë¦„user: 'admin',//ìœ ì €ì´ë¦„password: 'qwer1234',//ë¹„ë²ˆport: 5432,
});
```

2. ì´ëŸ° ì½”ë“œ ì„œë²„ì— ì‘ì„±í•´ë†“ê³ 

```jsx
app.get("/add", async (req, res) => {
  try {
    await pool.query(`CREATE TABLE IF NOT EXISTS products (
      id SERIAL PRIMARY KEY,
      title VARCHAR(255),
      price INT
    );`);
    res.send("SQL ì‹¤í–‰ ì™„ë£Œ");
  } catch (err) {
    console.log(err);
    res.send("ì‹¤íŒ¨");
  }
});
```

3. SQL ì‹¤í–‰ì´ í•„ìš”í•  ë•Œ ë§ˆë‹¤ pool.query() ì“°ë©´ ë©ë‹ˆë‹¤.
