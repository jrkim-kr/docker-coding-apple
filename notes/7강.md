# 핵심 정리

## 📚 학습 목표

1. **Docker Hub의 역할과 필요성 이해하기**
2. **Docker Hub 리포지토리 생성 및 관리하기**
3. **docker tag와 docker push로 이미지 업로드하기**
4. **docker pull로 이미지 다운로드하기**
5. **태그를 이용한 이미지 버전 관리 및 조직화 전략 수립하기**

---

## 📋 목차

### 1. Docker Hub 개요

- 1.1 Docker Hub란?
- 1.2 왜 Docker Hub를 사용하나?
- 1.3 대안 서비스들

### 2. 사전 준비

- 2.1 필요한 것들
- 2.2 Docker Hub 계정 생성

### 3. 리포지토리 생성

- 3.1 리포지토리 개념
- 3.2 리포지토리 생성 방법
- 3.3 Public vs Private

### 4. 이미지 업로드

- 4.1 Docker 로그인
- 4.2 이미지 태그 변경
- 4.3 이미지 푸시
- 4.4 업로드 확인

### 5. 이미지 다운로드

- 5.1 docker pull 사용법
- 5.2 다른 방법들

### 6. 실전 관리 전략

- 6.1 이미지 업데이트 관리
- 6.2 여러 이미지 조직화
- 6.3 보안 고려사항

### 7. 문제 해결

- 7.1 자주 발생하는 오류
- 7.2 유용한 명령어

---

## 1. Docker Hub 개요

### 1.1 Docker Hub란?

Docker Hub는 Docker 이미지를 위한 클라우드 기반 저장소 서비스입니다.

**비유:**

- GitHub = 코드 저장소
- Docker Hub = Docker 이미지 저장소

### 1.2 왜 Docker Hub를 사용하나?

**다른 전달 방법들:**

- USB로 이미지 파일 복사
- 이메일로 이미지 전송
- 파일 공유 서비스 이용

**Docker Hub의 장점:**

- ✅ 언제 어디서나 다운로드 가능
- ✅ 버전 관리 용이
- ✅ 팀 협업에 최적화
- ✅ 자동화 도구와 연동 가능
- ✅ 무료 사용 가능 (Public)

### 1.3 대안 서비스들

- **AWS ECR** (Amazon Elastic Container Registry)
- **Google Container Registry**
- **Azure Container Registry**
- 자체 호스팅 레지스트리

> 💡 이 튜토리얼에서는: 가장 쉽고 무료로 사용 가능한 Docker Hub를 사용합니다.

---

## 2. 사전 준비

### 2.1 필요한 것들

✓ Docker Desktop 설치

✓ 업로드할 Docker 이미지 (없다면 간단한 이미지 생성 필요)

✓ 인터넷 연결

### 2.2 Docker Hub 계정 생성

1. [hub.docker.com](https://hub.docker.com/) 접속
2. **Sign Up** 클릭
3. 이메일, 사용자명, 비밀번호 입력
4. 이메일 인증 완료
5. 로그인

---

## 3. 리포지토리 생성

### 3.1 리포지토리 개념

**리포지토리(Repository)**: Docker 이미지를 보관하는 폴더

**구조:**

```
사용자명/리포지토리명:태그
    ↓         ↓        ↓
codingapple/myserver:1

```

### 3.2 리포지토리 생성 방법

**단계별 가이드:**

1. Docker Hub 로그인 후 **"Repositories"** 탭 이동
2. **"Create Repository"** 버튼 클릭
3. 리포지토리 정보 입력:
   - **Name**: 리포지토리 이름 (예: `myserver`)
   - **Description**: 설명 (선택사항)
   - **Visibility**: Public 또는 Private 선택
4. **"Create"** 버튼 클릭

### 3.3 Public vs Private

| 구분       | Public                  | Private                    |
| ---------- | ----------------------- | -------------------------- |
| **비용**   | 무료 무제한             | 계정당 1개 무료            |
| **접근성** | 누구나 다운로드 가능    | 본인만 접근 가능           |
| **용도**   | 오픈소스, 공개 프로젝트 | 민감한 정보, 회사 프로젝트 |

> ⚠️ 주의: Public 리포지토리는 전 세계 누구나 접근 가능하므로, API 키나 비밀번호 같은 민감한 정보가 포함되지 않도록 주의하세요.

---

## 4. 이미지 업로드

### 4.1 Docker 로그인

터미널에서 Docker Hub에 로그인합니다.

```bash
docker login

```

**입력 사항:**

- Username: Docker Hub 사용자명
- Password: Docker Hub 비밀번호

**성공 메시지:**

```
Login Succeeded

```

### 4.2 이미지 태그 변경

**개념 이해:**

Docker 이미지를 Docker Hub에 업로드하려면, 이미지 이름이 리포지토리 이름과 정확히 일치해야 합니다.

**문법:**

```bash
docker tag 기존이미지명:태그 사용자명/리포지토리명:새태그

```

**실제 예시:**

```bash
docker tag nodeserver:1 codingapple/myserver:1

```

**구조 분석:**

- `nodeserver:1` → 현재 로컬에 있는 이미지
- `codingapple/myserver:1` → Docker Hub에 업로드될 이름

**확인:**

```bash
docker images

```

**결과:**

```
REPOSITORY              TAG    IMAGE ID      CREATED       SIZE
nodeserver              1      abc123def     2 hours ago   150MB
codingapple/myserver    1      abc123def     2 hours ago   150MB

```

> 💡 중요: IMAGE ID가 같으면 실제로는 같은 이미지입니다. 단지 이름표가 2개 붙은 것뿐이므로 용량을 2배 차지하지 않습니다.

### 4.3 이미지 푸시

**문법:**

```bash
docker push 사용자명/리포지토리명:태그

```

**실제 예시:**

```bash
docker push codingapple/myserver:1

```

**업로드 과정:**

```
The push refers to repository [docker.io/codingapple/myserver]
5f70bf18a086: Pushed
e493e9f21f56: Pushed
1: digest: sha256:abc123... size: 1234

```

### 4.4 업로드 확인

1. Docker Hub 웹사이트 접속
2. 리포지토리로 이동
3. **"Tags"** 탭에서 업로드된 이미지 확인

---

## 5. 이미지 다운로드

### 5.1 docker pull 사용법

다른 컴퓨터나 환경에서 이미지를 다운로드합니다.

**문법:**

```bash
docker pull 사용자명/리포지토리명:태그

```

**실제 예시:**

```bash
docker pull codingapple/myserver:1

```

**다운로드 과정:**

```
1: Pulling from codingapple/myserver
5f70bf18a086: Pull complete
e493e9f21f56: Pull complete
Status: Downloaded newer image for codingapple/myserver:1

```

**확인:**

```bash
docker images

```

### 5.2 다른 방법들

**Docker Desktop 사용:**

1. Docker Desktop 실행
2. **"Images"** 탭 이동
3. 검색창에 이미지 이름 입력
4. **"Pull"** 버튼 클릭

---

## 6. 실전 관리 전략

### 6.1 이미지 업데이트 관리

**방법 1: 태그 버전 관리**

```bash
# 초기 버전
docker build -t myapp:1.0 .
docker tag myapp:1.0 codingapple/myserver:1.0
docker push codingapple/myserver:1.0

# 업데이트 버전
docker build -t myapp:1.1 .
docker tag myapp:1.1 codingapple/myserver:1.1
docker push codingapple/myserver:1.1

# latest 태그도 업데이트
docker tag myapp:1.1 codingapple/myserver:latest
docker push codingapple/myserver:latest

```

**권장 태그 전략:**

- `latest`: 최신 안정 버전
- `1.0`, `1.1`: 특정 버전
- `dev`: 개발 버전
- `staging`: 스테이징 버전

### 6.2 여러 이미지 조직화

**시나리오**: 백엔드, 프론트엔드, 데이터베이스 이미지가 있는 경우

**방법 1: 별도 리포지토리 (권장)**

```
codingapple/backend:1.0
codingapple/frontend:1.0
codingapple/database:1.0

```

**장점:**

- ✅ 명확한 구분
- ✅ 독립적인 버전 관리
- ✅ 접근 권한 개별 설정 가능

**방법 2: 하나의 리포지토리에 다른 태그**

```
codingapple/myproject:backend-1.0
codingapple/myproject:frontend-1.0
codingapple/myproject:database-1.0

```

**장점:**

- ✅ 하나의 Private 리포지토리로 모두 관리
- ✅ 관리 포인트 단순화

**단점:**

- ❌ 혼란 가능성
- ❌ 버전 관리 복잡

### 6.3 보안 고려사항

**체크리스트:**

- [ ] 민감한 정보는 이미지에 포함하지 않기
  - API 키, 비밀번호, 인증서 등
- [ ] 환경 변수로 민감 정보 전달
- [ ] `.dockerignore` 파일 활용
- [ ] Private 리포지토리 사용 (필요시)
- [ ] 정기적인 이미지 업데이트 및 보안 패치

---

## 7. 문제 해결

### 7.1 자주 발생하는 오류

**오류 1: 로그인 실패**

```
Error: Cannot connect to the Docker daemon

```

**해결:**

```bash
# Docker Desktop이 실행 중인지 확인
docker login

```

**오류 2: 권한 거부**

```
denied: requested access to the resource is denied

```

**해결:**

- Docker Hub 로그인 확인
- 리포지토리 이름이 정확한지 확인
- 사용자명이 이미지 이름에 포함되었는지 확인

**오류 3: 이미지를 찾을 수 없음**

```
Error response from daemon: manifest for image not found

```

**해결:**

- 이미지 이름과 태그 철자 확인
- `docker images`로 로컬 이미지 목록 확인

### 7.2 유용한 명령어

```bash
# 로컬 이미지 목록 확인
docker images

# 특정 이미지 삭제
docker rmi 이미지명:태그

# 사용하지 않는 이미지 일괄 삭제
docker image prune

# 로그아웃
docker logout

# 이미지 정보 상세 확인
docker inspect 이미지명:태그

```

---

## 📝 요약

### 핵심 명령어

```bash
# 로그인
docker login

# 이미지 이름 변경
docker tag 기존이미지:태그 사용자명/리포지토리명:새태그

# 이미지 업로드
docker push 사용자명/리포지토리명:태그

# 이미지 다운로드
docker pull 사용자명/리포지토리명:태그

```

### 작업 흐름

```
1. Docker Hub 계정 생성
         ↓
2. 리포지토리 생성
         ↓
3. docker login
         ↓
4. docker tag (이미지 이름 변경)
         ↓
5. docker push (업로드)
         ↓
6. docker pull (다운로드)
```

---

## 🎯 실습 과제

1. Docker Hub 계정을 만들고 Public 리포지토리 생성하기
2. 로컬에 있는 이미지를 Docker Hub에 업로드하기
3. 다른 컴퓨터(또는 이미지를 삭제한 후)에서 업로드한 이미지 다운로드하기
4. 이미지를 수정하고 새로운 태그로 다시 업로드하기
