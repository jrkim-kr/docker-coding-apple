# 핵심 정리

## 📚 학습 목표

1. **Docker Hub의 역할과 필요성 이해하기**
2. **Docker Hub 리포지토리 생성 및 관리하기**
3. **docker tag와 docker push로 이미지 업로드하기**
4. **docker pull로 이미지 다운로드하기**
5. **태그를 이용한 이미지 버전 관리 및 조직화 전략 수립하기**

---

## 📋 목차

### 1. Docker Hub 개요

- 1.1 Docker Hub란?
- 1.2 왜 Docker Hub를 사용하나?
- 1.3 대안 서비스들

### 2. 사전 준비

- 2.1 필요한 것들
- 2.2 Docker Hub 계정 생성

### 3. 리포지토리 생성

- 3.1 리포지토리 개념
- 3.2 리포지토리 생성 방법
- 3.3 Public vs Private

### 4. 이미지 업로드

- 4.1 Docker 로그인
- 4.2 이미지 태그 변경
- 4.3 이미지 푸시
- 4.4 업로드 확인

### 5. 이미지 다운로드

- 5.1 docker pull 사용법
- 5.2 다른 방법들

### 6. 실전 관리 전략

- 6.1 이미지 업데이트 관리
- 6.2 여러 이미지 조직화
- 6.3 보안 고려사항

### 7. 문제 해결

- 7.1 자주 발생하는 오류
- 7.2 유용한 명령어

---

## 1. Docker Hub 개요

### 1.1 Docker Hub란?

Docker Hub는 Docker 이미지를 위한 클라우드 기반 저장소 서비스입니다.

**비유:**

- GitHub = 코드 저장소
- Docker Hub = Docker 이미지 저장소

### 1.2 왜 Docker Hub를 사용하나?

**다른 전달 방법들:**

- USB로 이미지 파일 복사
- 이메일로 이미지 전송
- 파일 공유 서비스 이용

**Docker Hub의 장점:**

- ✅ 언제 어디서나 다운로드 가능
- ✅ 버전 관리 용이
- ✅ 팀 협업에 최적화
- ✅ 자동화 도구와 연동 가능
- ✅ 무료 사용 가능 (Public)

### 1.3 대안 서비스들

- **AWS ECR** (Amazon Elastic Container Registry)
- **Google Container Registry**
- **Azure Container Registry**
- 자체 호스팅 레지스트리

> 💡 이 튜토리얼에서는: 가장 쉽고 무료로 사용 가능한 Docker Hub를 사용합니다.

---

## 2. 사전 준비

### 2.1 필요한 것들

✓ Docker Desktop 설치

✓ 업로드할 Docker 이미지 (없다면 간단한 이미지 생성 필요)

✓ 인터넷 연결

### 2.2 Docker Hub 계정 생성

1. [hub.docker.com](https://hub.docker.com/) 접속
2. **Sign Up** 클릭
3. 이메일, 사용자명, 비밀번호 입력
4. 이메일 인증 완료
5. 로그인

---

## 3. 리포지토리 생성

### 3.1 리포지토리 개념

**리포지토리(Repository)**: Docker 이미지를 보관하는 폴더

**구조:**

```
사용자명/리포지토리명:태그
    ↓         ↓        ↓
codingapple/myserver:1

```

### 3.2 리포지토리 생성 방법

**단계별 가이드:**

1. Docker Hub 로그인 후 **"Repositories"** 탭 이동
2. **"Create Repository"** 버튼 클릭
3. 리포지토리 정보 입력:
   - **Name**: 리포지토리 이름 (예: `myserver`)
   - **Description**: 설명 (선택사항)
   - **Visibility**: Public 또는 Private 선택
4. **"Create"** 버튼 클릭

### 3.3 Public vs Private

| 구분       | Public                  | Private                    |
| ---------- | ----------------------- | -------------------------- |
| **비용**   | 무료 무제한             | 계정당 1개 무료            |
| **접근성** | 누구나 다운로드 가능    | 본인만 접근 가능           |
| **용도**   | 오픈소스, 공개 프로젝트 | 민감한 정보, 회사 프로젝트 |

> ⚠️ 주의: Public 리포지토리는 전 세계 누구나 접근 가능하므로, API 키나 비밀번호 같은 민감한 정보가 포함되지 않도록 주의하세요.

---

## 4. 이미지 업로드

### 4.1 Docker 로그인

터미널에서 Docker Hub에 로그인합니다.

```bash
docker login

```

**입력 사항:**

- Username: Docker Hub 사용자명
- Password: Docker Hub 비밀번호

**성공 메시지:**

```
Login Succeeded

```

### 4.2 이미지 태그 변경

**개념 이해:**

Docker 이미지를 Docker Hub에 업로드하려면, 이미지 이름이 리포지토리 이름과 정확히 일치해야 합니다.

**문법:**

```bash
docker tag 기존이미지명:태그 사용자명/리포지토리명:새태그

```

**실제 예시:**

```bash
docker tag nodeserver:1 codingapple/myserver:1

```

**구조 분석:**

- `nodeserver:1` → 현재 로컬에 있는 이미지
- `codingapple/myserver:1` → Docker Hub에 업로드될 이름

**확인:**

```bash
docker images

```

**결과:**

```
REPOSITORY              TAG    IMAGE ID      CREATED       SIZE
nodeserver              1      abc123def     2 hours ago   150MB
codingapple/myserver    1      abc123def     2 hours ago   150MB

```

> 💡 중요: IMAGE ID가 같으면 실제로는 같은 이미지입니다. 단지 이름표가 2개 붙은 것뿐이므로 용량을 2배 차지하지 않습니다.

### 4.3 이미지 푸시

**문법:**

```bash
docker push 사용자명/리포지토리명:태그

```

**실제 예시:**

```bash
docker push codingapple/myserver:1

```

**업로드 과정:**

```
The push refers to repository [docker.io/codingapple/myserver]
5f70bf18a086: Pushed
e493e9f21f56: Pushed
1: digest: sha256:abc123... size: 1234

```

### 4.4 업로드 확인

1. Docker Hub 웹사이트 접속
2. 리포지토리로 이동
3. **"Tags"** 탭에서 업로드된 이미지 확인

---

## 5. 이미지 다운로드

### 5.1 docker pull 사용법

다른 컴퓨터나 환경에서 이미지를 다운로드합니다.

**문법:**

```bash
docker pull 사용자명/리포지토리명:태그

```

**실제 예시:**

```bash
docker pull codingapple/myserver:1

```

**다운로드 과정:**

```
1: Pulling from codingapple/myserver
5f70bf18a086: Pull complete
e493e9f21f56: Pull complete
Status: Downloaded newer image for codingapple/myserver:1

```

**확인:**

```bash
docker images

```

### 5.2 다른 방법들

**Docker Desktop 사용:**

1. Docker Desktop 실행
2. **"Images"** 탭 이동
3. 검색창에 이미지 이름 입력
4. **"Pull"** 버튼 클릭

---

## 6. 실전 관리 전략

### 6.1 이미지 업데이트 관리

**방법 1: 태그 버전 관리**

```bash
# 초기 버전
docker build -t myapp:1.0 .
docker tag myapp:1.0 codingapple/myserver:1.0
docker push codingapple/myserver:1.0

# 업데이트 버전
docker build -t myapp:1.1 .
docker tag myapp:1.1 codingapple/myserver:1.1
docker push codingapple/myserver:1.1

# latest 태그도 업데이트
docker tag myapp:1.1 codingapple/myserver:latest
docker push codingapple/myserver:latest

```

**권장 태그 전략:**

- `latest`: 최신 안정 버전
- `1.0`, `1.1`: 특정 버전
- `dev`: 개발 버전
- `staging`: 스테이징 버전

### 6.2 여러 이미지 조직화

**시나리오**: 백엔드, 프론트엔드, 데이터베이스 이미지가 있는 경우

**방법 1: 별도 리포지토리 (권장)**

```
codingapple/backend:1.0
codingapple/frontend:1.0
codingapple/database:1.0

```

**장점:**

- ✅ 명확한 구분
- ✅ 독립적인 버전 관리
- ✅ 접근 권한 개별 설정 가능

**방법 2: 하나의 리포지토리에 다른 태그**

```
codingapple/myproject:backend-1.0
codingapple/myproject:frontend-1.0
codingapple/myproject:database-1.0

```

**장점:**

- ✅ 하나의 Private 리포지토리로 모두 관리
- ✅ 관리 포인트 단순화

**단점:**

- ❌ 혼란 가능성
- ❌ 버전 관리 복잡

### 6.3 보안 고려사항

**체크리스트:**

- [ ] 민감한 정보는 이미지에 포함하지 않기
  - API 키, 비밀번호, 인증서 등
- [ ] 환경 변수로 민감 정보 전달
- [ ] `.dockerignore` 파일 활용
- [ ] Private 리포지토리 사용 (필요시)
- [ ] 정기적인 이미지 업데이트 및 보안 패치

---

## 7. 문제 해결

### 7.1 자주 발생하는 오류

**오류 1: 로그인 실패**

```
Error: Cannot connect to the Docker daemon

```

**해결:**

```bash
# Docker Desktop이 실행 중인지 확인
docker login

```

**오류 2: 권한 거부**

```
denied: requested access to the resource is denied

```

**해결:**

- Docker Hub 로그인 확인
- 리포지토리 이름이 정확한지 확인
- 사용자명이 이미지 이름에 포함되었는지 확인

**오류 3: 이미지를 찾을 수 없음**

```
Error response from daemon: manifest for image not found

```

**해결:**

- 이미지 이름과 태그 철자 확인
- `docker images`로 로컬 이미지 목록 확인

### 7.2 유용한 명령어

```bash
# 로컬 이미지 목록 확인
docker images

# 특정 이미지 삭제
docker rmi 이미지명:태그

# 사용하지 않는 이미지 일괄 삭제
docker image prune

# 로그아웃
docker logout

# 이미지 정보 상세 확인
docker inspect 이미지명:태그

```

---

## 📝 요약

### 핵심 명령어

```bash
# 로그인
docker login

# 이미지 이름 변경
docker tag 기존이미지:태그 사용자명/리포지토리명:새태그

# 이미지 업로드
docker push 사용자명/리포지토리명:태그

# 이미지 다운로드
docker pull 사용자명/리포지토리명:태그

```

### 작업 흐름

```
1. Docker Hub 계정 생성
         ↓
2. 리포지토리 생성
         ↓
3. docker login
         ↓
4. docker tag (이미지 이름 변경)
         ↓
5. docker push (업로드)
         ↓
6. docker pull (다운로드)
```

---

## 🎯 실습 과제

1. Docker Hub 계정을 만들고 Public 리포지토리 생성하기
2. 로컬에 있는 이미지를 Docker Hub에 업로드하기
3. 다른 컴퓨터(또는 이미지를 삭제한 후)에서 업로드한 이미지 다운로드하기
4. 이미지를 수정하고 새로운 태그로 다시 업로드하기

# 강의 스크립트

프로그램을 이미지로 만들어두면 이제 다른 컴퓨터에서 쉽게 실행할 수 있다고 했습니다.

근데 다른 컴퓨터로 보내는 법은 안알려줬는데요?

실은 USB로 전달하든 이메일로 전달하든 아무렇게나 해도 되는데

근데 보통은 이미지 호스팅해주는 서비스에 업로드하고 필요할 때 다운로드하고 그렇게 하는게 편리합니다.

docker hub 이런 곳이나 AWS ECR 이런 곳들을 사용하면 되는데

쉽게 무료로 이용할 수 있는 docker hub에 올려보도록 합시다.

> 리포지토리 만들기

Docker hub 사이트에 방문해봅시다. (hub.docker.com)

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%981-3.png)

▲ 가입하고 로그인해보면 리포지토리를 만드는 버튼이 어딘가에 있을텐데 눌러봅시다.

리포지토리는 "이미지 보관용 폴더"입니다.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%982-2.png)

▲ 리포지토리 이름 작명하고 public이 무료라 그걸로 선택하면 됩니다.

(대신 public은 아무나 볼 수 있습니다)

그리고 오른쪽에 이미지 업로드하는 방법 그대로 따라하면 업로드 가능합니다.

> 이미지 업로드는 docker push

저번에 만든 이미지 하나를 저기 방금만든 리포지토리에 올려봅시다.

없으면 이미지 아무거나 도커허브에서 다운받아서 올려봅시다.

```
docker tag 이미지이름:태그명 리포지토리이름:태그명작명
docker push 리포지토리이름:태그명작명
```

일단 이미지 올리려면 터미널 명령어가 2개 필요한데

첫째는 일단 이미지 이름을 바꾸는 명령어고

두번째가 올리는 명령어입니다.

이미지 이름부터 바꿔야 하는 이유는

원래 **이미지 이름에 정확히 그 리포지토리 이름이 들어가야** 리포지토리에 올릴 수 있습니다.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%983-3.png)

▲ 저는 리포지토리 이름을 codingapple/myserver 이렇게 만들었기 때문에

```
docker tag nodeserver:1 codingapple/myserver:1
docker push codingapple/myserver:1
```

이런 식으로 이미지 이름을 바꾸고 올려봤습니다.

뭔가 안된다고 나오면 터미널에 docker login부터 입력해서 로그인 하라는거 해보시면 되겠습니다.

![](https://d2hxk0kgvzehcg.cloudfront.net/wp-content/uploads/2024/11/%EC%BA%A1%EC%B2%984-3.png)

▲ 참고로 docker tag 이용해서 이미지 이름을 바꾸면

이미지 목록에 이미지가 하나 더 추가됩니다.

그래서 뭔가 용량도 2배 차지하게 되고 그럴 것 같은데 ID가 동일하면 실은 같은 이미지입니다.

원래 이미지는 여러개의 이름을 가질 수 있습니다.

그냥 모든 이미지 이름을 보여주는 곳이라고 보면 되겠습니다.

> pull하기

```
docker pull 이미지명:태그
```

이미지를 docker hub에서 내려받으려면 docker pull 명령어를 쓰면 됩니다.

실은 docker desktop 에서도 올리고 내려받을 수 있기 때문에 그런 식으로 써보셔도 되겠습니다.

**Q. 이미지 업데이트된거 올리고싶으면?**

- 태그명을 다르게 작성해서 이미지 새로 빌드하고 올리면 됩니다.

**Q. 다른 종류의 이미지도 업로드하고 싶으면?**

예를 들어 서버 담은 이미지, 프론트엔드 담은 이미지, DB 담은 이미지 이런게 있으면

각각 어디에 업로드하는게 좋겠습니까.

- 이런 경우엔 각각 별도의 리포지토리를 만들어서 거기에 업로드하는 경우들이 많습니다.

근데 귀찮아서 혹은 private 리포지토리 하나가지고 계속 쓰고 싶어서 하나의 리포지토리에 태그명만 다르게 해서 쑤셔넣는 경우도 있습니다.

하지만 이미지 종류마다 별도의 리포지토리를 만드는게 깔끔합니다.

(참고) 리포지토리 만들 때 private 말고 public 으로 만들면 아무나 이걸 다운받을 수 있기 때문에

좀 민감한 내용이 들어있는 것들은 private 리포지토리에 올려두시면 되겠습니다.

하지만 private 리포지토리는 계정마다 1개만 생성가능합니다.
