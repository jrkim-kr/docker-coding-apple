# 핵심 정리

## 📚 학습 목표

이 튜토리얼을 통해 다음을 배울 수 있습니다:

- Docker 컨테이너를 터미널에서 실행하는 방법
- 포트 설정의 원리와 필요성
- 컨테이너 관리 핵심 명령어들
- 컨테이너의 내부 구조와 동작 원리

---

## 1️⃣ Docker 컨테이너 실행하기

### 기본 실행 명령어

```bash
docker run 이미지명:태그명

```

**문제점:** 이 명령어를 실행하면 터미널이 점유되어 다른 작업을 할 수 없습니다.

### 백그라운드 실행 (권장)

```bash
docker run -d 이미지명:태그명

```

- `d` 옵션: **detached**의 약자
  - **detached**: "분리된, 떨어진"이라는 의미
  - 터미널과 컨테이너를 분리하여 실행한다는 뜻
- **백그라운드 실행**: 프로그램이 화면에 보이지 않는 곳에서 조용히 돌아가는 것
  - 마치 컴퓨터를 켜놓고 음악을 들으면서 다른 작업을 하는 것처럼
  - 컨테이너는 뒤에서 계속 돌아가고, 터미널은 다른 명령어를 입력할 수 있음

### 실습 예제

```bash
# nginx 웹서버를 백그라운드에서 실행
docker run -d nginx:latest

```

**nginx란?**

- 전 세계에서 가장 많이 사용되는 웹서버 소프트웨어
- 웹페이지를 보여주는 프로그램 (아파치와 비슷한 역할)
- 가볍고 빠르며 안정적이어서 실습용으로 자주 사용

---

## 2️⃣ 포트 설정의 이해

### 포트 설정 명령어

```bash
docker run -p 8081:8080 -d 이미지명:태그명

```

- **형식:** `p 내컴퓨터포트:컨테이너포트`
- **의미:** 내 컴퓨터의 8081포트로 들어오는 요청을 컨테이너의 8080포트로 전달

### 🤔 왜 포트 설정이 필요할까?

### 포트 설정 없이 실행했을 때

```
브라우저 → localhost:8080 → 내 컴퓨터 8080포트 → ❌ 아무것도 없음

```

**왜 localhost:8080인가?**

- nginx는 기본적으로 80번 포트를 사용
- 하지만 예시에서는 8080을 사용한 이유:
  - 80번 포트는 관리자 권한이 필요한 경우가 많음
  - 8080은 개발할 때 자주 사용하는 대안 포트
  - 실제로는 어떤 포트 번호든 사용 가능

### 포트 설정을 했을 때

```
브라우저 → localhost:8081 → 내 컴퓨터 8081포트 → 컨테이너 8080포트 → ✅ 웹서버 응답

```

### 핵심 개념

- **localhost**: 내 컴퓨터를 의미
- **컨테이너**: 내 컴퓨터 안의 가상 컴퓨터
- **포트 연결**: 내 컴퓨터와 가상 컴퓨터를 연결하는 다리 역할

### 실습 예제

```bash
# nginx를 8081포트로 실행
docker run -p 8081:80 -d nginx:latest

# 브라우저에서 localhost:8081 접속하여 확인

```

---

## 3️⃣ 컨테이너 관리 명령어

### 실행 중인 컨테이너 확인

```bash
docker ps

```

- **ps**: **Process Status**의 약자
  - 리눅스에서 실행 중인 프로세스(프로그램)를 보는 명령어에서 유래
  - Docker에서는 실행 중인 컨테이너들을 의미
- 현재 실행 중인 모든 컨테이너의 정보를 표시
- 컨테이너 **ID (Identifier)**, 이름, 포트 등을 확인할 수 있음

### 컨테이너 로그 확인

```bash
docker logs 컨테이너이름

```

- 컨테이너 내부의 터미널 출력 내용을 확인
- 오류 진단이나 상태 확인에 유용
- **logs**: **log**의 복수형 - 시스템이나 프로그램의 동작 기록

### 컨테이너 내부 접속

```bash
docker exec -it 컨테이너이름 sh

```

- 실행 중인 컨테이너의 터미널에 접속
- **it**: **interactive terminal** 옵션
  - **i**: **interactive**의 약자 - 상호작용할 수 있는 (명령어를 입력하고 결과를 받을 수 있는)
  - **t**: **terminal**의 약자 - 명령어를 입력할 수 있는 화면
- **sh**: **shell**의 약자
  - **shell**: "껍데기"라는 뜻으로, 사용자와 운영체제 사이의 인터페이스
  - 리눅스에서 명령어를 해석하고 실행하는 프로그램
  - **sh (Bourne Shell)**: 1977년 Stephen Bourne이 개발한 가장 기본적인 셸
  - **bash (Bourne Again Shell)**: sh를 개선한 버전, 리눅스 기본 셸
  - **zsh (Z Shell)**: bash보다 더 많은 기능을 가진 현대적 셸, macOS 기본 셸
  - sh → bash → zsh 순으로 발전했지만, sh가 가장 호환성이 좋아서 컨테이너에서 자주 사용
- 컨테이너 내부에서 명령어 실행 가능

### 컨테이너에서 사용할 수 있는 기본 명령어들

- **ls**: **List**의 약자 - 현재 폴더의 파일 목록 보기
- **cat 파일명**: **concatenate**의 약자 - 파일 내용 읽기 (원래는 여러 파일을 연결하는 기능)
- **pwd**: **Print Working Directory**의 약자 - 현재 위치 확인
- **cd 폴더명**: **Change Directory**의 약자 - 폴더 이동

### 컨테이너 탈출 방법

- **방법 1:** `Ctrl + P` 후 `Ctrl + Q` (컨테이너는 계속 실행됨)
- **방법 2:** `exit` 명령어 입력 (컨테이너에서 완전히 나옴)

### 컨테이너 정지

```bash
docker stop 컨테이너이름

```

- 실행 중인 컨테이너를 안전하게 정지
- 컨테이너 ID를 사용해도 됨

### 컨테이너 삭제

```bash
docker rm 컨테이너이름

```

- **rm**: **remove**의 약자 - 정지된 컨테이너를 완전히 삭제
- 실행 중인 컨테이너를 강제 삭제: `docker rm -f 컨테이너이름`
- **f**: **force**의 약자 - 강제로 실행

---

## 4️⃣ 실습 워크플로우

### Step 1: 컨테이너 실행

```bash
docker run -p 8080:80 -d --name my-nginx nginx:latest

```

### Step 2: 컨테이너 확인

```bash
docker ps

```

### Step 3: 브라우저에서 테스트

- `localhost:8080` 접속하여 nginx 페이지 확인

### Step 4: 컨테이너 내부 탐색

```bash
docker exec -it my-nginx sh
ls                              # 파일 목록 보기
cat /etc/nginx/nginx.conf       # nginx 설정 파일 내용 읽기
exit                            # 컨테이너에서 나오기

```

**명령어 설명:**

- **ls**: **List**의 약자 - 현재 폴더에 있는 파일과 폴더 목록을 보여줌
- **cat**: **concatenate**의 약자 - 파일의 내용을 화면에 출력 (원래는 여러 파일을 연결하는 기능)
- **/etc/nginx/nginx.conf**: nginx 웹서버의 설정이 저장된 파일 경로

### Step 5: 로그 확인

```bash
docker logs my-nginx

```

### Step 6: 컨테이너 정리

```bash
docker stop my-nginx
docker rm my-nginx

```

---

## 5️⃣ 컨테이너의 실체와 구조

### 컨테이너란?

컨테이너는 **가상 컴퓨터가 아닙니다!** 리눅스 OS의 기능을 조합한 **프로세스 격리 기술**입니다.

### 핵심 기술들

### 1. Namespace (네임스페이스)

- **역할**: 프로세스와 파일 시스템을 독립적으로 분리
- **효과**: 각 컨테이너가 서로 영향을 주지 않고 실행

### 2. Cgroup (컨트롤 그룹)

- **역할**: CPU, 메모리 사용량 제한
- **효과**: 리소스 사용량을 제어하여 시스템 안정성 확보

### Docker의 위치

```
Docker (사용자 친화적 인터페이스)
    ↓
containerd (컨테이너 관리)
    ↓
runc (실제 컨테이너 실행)
    ↓
Linux Kernel (namespace, cgroup)

```

### Docker의 장점

- **격리성**: 컨테이너 문제가 호스트로 전파되지 않음
- **효율성**: 한 대의 컴퓨터에서 여러 서비스 운영
- **이식성**: 어떤 환경에서든 동일하게 실행
- **확장성**: 필요에 따라 컨테이너 수량 조절

---

## 6️⃣ Docker 대안들

- **Podman**: Docker와 호환되는 데몬리스 컨테이너 엔진
- **Orbstack**: macOS 전용 경량 컨테이너 런타임
- **containerd**: 저수준 컨테이너 런타임

---

## 💡 핵심 요약

1. **백그라운드 실행**: `d` 옵션 사용
2. **포트 연결**: `p 호스트포트:컨테이너포트`
3. **컨테이너 관리**: `ps`, `logs`, `exec`, `stop`, `rm`
4. **컨테이너 본질**: 리눅스 커널 기능을 활용한 프로세스 격리
5. **실용성**: Docker Desktop GUI로도 대부분 작업 가능

### 📝 기억해야 할 명령어

```bash
# 필수 명령어 모음
docker run -p 8080:80 -d nginx        # 실행
docker ps                             # 확인
docker exec -it 컨테이너명 sh          # 접속
docker logs 컨테이너명                 # 로그
docker stop 컨테이너명                 # 정지
docker rm 컨테이너명                   # 삭제
```
